<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="edu.sm.repository.BidRepository">

    <!-- ìž…ì°° ì¶”ê°€ -->
    <insert id="insert" parameterType="edu.sm.dto.Bid">
        INSERT INTO bid (user_id, product_id, bid_price, bid_date)
        VALUES (#{bidUserId}, #{productId}, #{bidPrice}, #{bidDate})
    </insert>

    <!-- ìµœê³  ìž…ì°° ë‚´ì—­ ì¡°íšŒ -->
    <select id="getHighestBid" parameterType="int" resultType="edu.sm.dto.Bid">
        SELECT
            user_id as bidUserId,
            product_id as productId,
            bid_price as bidPrice,
            bid_date as bidDate
        FROM bid
        WHERE product_id = #{productId}
        ORDER BY bid_price DESC
            LIMIT 1
    </select>

    <!-- ðŸ”¥ ìµœê³  ìž…ì°°ê°€ë§Œ ì¡°íšŒ (í˜„ìž¬ê°€ë¡œ ì‚¬ìš©) -->
    <select id="findHighestBidPriceByProductId" parameterType="int" resultType="int">
        SELECT MAX(bid_price)
        FROM bid
        WHERE product_id = #{productId}
    </select>

</mapper>
